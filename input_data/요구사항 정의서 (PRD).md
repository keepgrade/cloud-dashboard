# 요구사항 정의서 (PRD)

## 1. 문서 개요

| 항목 | 내용 |
| --- | --- |
| **프로젝트명** | 가비아 클라우드 서비스 지표 대시보드 |
| **작성자** | Ted(신태선) - 클라우드기획팀 |
| **작성일** | 2026-01-14 |
| **버전** | v1.0 |
| **기술 스택** | Python Shiny (Express), Matplotlib, Seaborn |

---

## 2. 기능 요구사항 (Functional Requirements)

### 2.1 필터 기능

| ID | 요구사항명 | 상세 설명 | 입력 | 출력 | 우선순위 |
| --- | --- | --- | --- | --- | --- |
| FR-001 | 월 과금 범위 필터 | 사용자가 범위 슬라이더를 조작하여 월 과금(monthly_cost_krw) 범위를 지정할 수 있다 | 슬라이더 min/max 값 | 범위 내 데이터만 필터링 | 상 |
| FR-002 | 트래픽 구간 필터 | 업무시간(BUSINESS), 야간/피크(PEAK) 중 원하는 구간을 체크박스로 선택할 수 있다 | 체크박스 선택값 | 선택된 구간 데이터만 필터링 | 상 |
| FR-003 | 필터 초기화 | "필터 초기화" 버튼 클릭 시 모든 필터가 기본값으로 복원된다 | 버튼 클릭 | 슬라이더: 전체범위, 체크박스: 모두선택 | 중 |

---

### 2.2 지표 표시 기능

| ID | 요구사항명 | 상세 설명 | 계산 로직 | 표시 형식 | 우선순위 |
| --- | --- | --- | --- | --- | --- |
| FR-004 | 조회 대상 건수 | 필터 조건에 부합하는 데이터 건수를 Value Box에 표시한다 | `len(filtered_data)` | 정수 (예: 1,234) | 상 |
| FR-005 | 평균 오버리지 비중 | 필터링된 데이터의 평균 오버리지 비중을 표시한다 | `mean(overage_cost / monthly_cost)` | 백분율 소수점 1자리 (예: 12.5%) | 상 |
| FR-006 | 평균 월 과금 | 필터링된 데이터의 평균 월 과금을 표시한다 | `mean(monthly_cost_krw)` | 원화 천단위 콤마 (예: ₩1,234,567) | 상 |

---

### 2.3 데이터 시각화 기능

| ID | 요구사항명 | 상세 설명 | 차트 유형 | 옵션 | 우선순위 |
| --- | --- | --- | --- | --- | --- |
| FR-007 | 원천 데이터 미리보기 | 필터링된 데이터를 그리드 테이블 형태로 제공한다 | DataGrid | 최대 200행 표시 | 중 |
| FR-008 | 월과금 vs 오버리지 산점도 | 두 변수 간 상관관계를 산점도로 시각화한다 | Scatter Plot | 색상 기준 선택 가능 | 상 |
| FR-009 | 산점도 색상 옵션 | 산점도의 점 색상을 그룹별로 구분할 수 있다 | - | 없음/세그먼트/프로모션/요일/트래픽 | 중 |
| FR-010 | 오버리지 비중 분포 | 오버리지 비중의 분포를 그룹별로 시각화한다 | Violin Plot | 그룹 기준 선택 가능 | 상 |
| FR-011 | 분포 차트 그룹 옵션 | 바이올린 플롯의 그룹 기준을 변경할 수 있다 | - | 세그먼트/프로모션/요일/트래픽 | 중 |

---

### 2.4 실시간 반응 기능

| ID | 요구사항명 | 상세 설명 | 트리거 | 영향 범위 | 우선순위 |
| --- | --- | --- | --- | --- | --- |
| FR-012 | 실시간 데이터 갱신 | 필터 변경 시 모든 컴포넌트가 실시간으로 갱신된다 | 필터 값 변경 | Value Box 3개 + 차트 3개 | 상 |
| FR-013 | 차트 옵션 반응 | 차트 옵션 변경 시 해당 차트만 즉시 리렌더링된다 | 라디오버튼 선택 | 해당 차트 | 중 |

---

## 3. 비기능 요구사항 (Non-Functional Requirements)

### 3.1 성능

| ID | 요구사항명 | 상세 설명 | 기준값 | 우선순위 |
| --- | --- | --- | --- | --- |
| NFR-001 | 초기 로딩 속도 | 대시보드 첫 로딩 완료 시간 | 3초 이내 | 상 |
| NFR-002 | 필터 반응 속도 | 필터 변경 후 차트 갱신 완료 시간 | 2초 이내 | 상 |
| NFR-003 | 차트 렌더링 | 개별 차트 렌더링 완료 시간 | 1초 이내 | 중 |

---

### 3.2 사용성 (UI/UX)

| ID | 요구사항명 | 상세 설명 | 기준 | 우선순위 |
| --- | --- | --- | --- | --- |
| NFR-004 | 반응형 사이드바 | 데스크톱에서 사이드바 기본 열림, 모바일에서 기본 닫힘 | `open="desktop"` | 중 |
| NFR-005 | 전체화면 지원 | 각 카드(차트)는 전체화면으로 확대 가능해야 함 | `full_screen=True` | 하 |
| NFR-006 | 직관적 아이콘 | Value Box에 의미를 나타내는 아이콘 표시 | FontAwesome 아이콘 | 하 |

---

### 3.3 예외 처리

| ID | 요구사항명 | 상세 설명 | 처리 방식 | 우선순위 |
| --- | --- | --- | --- | --- |
| NFR-007 | 빈 데이터 처리 - 지표 | 필터 결과가 0건일 때 Value Box 표시 | "-" 문자 표시 | 상 |
| NFR-008 | 빈 데이터 처리 - 차트 | 필터 결과가 0건일 때 차트 표시 | "필터 결과가 없습니다." 메시지 | 상 |
| NFR-009 | 0으로 나누기 방지 | monthly_cost_krw가 0일 때 오버리지 비중 계산 | NULL 처리 후 평균 계산에서 제외 | 상 |

---

## 4. 데이터 요구사항

### 4.1 입력 데이터 스키마 (tips 데이터셋)

| 필드명 | 데이터 타입 | 설명 | 필수 | 예시 |
| --- | --- | --- | --- | --- |
| `monthly_cost_krw` | Integer | 월 과금 금액 (원) | Y | 150000 |
| `overage_cost_krw` | Integer | 오버리지 비용 (원) | Y | 25000 |
| `traffic_window` | String | 트래픽 구간 | Y | "BUSINESS" 또는 "PEAK" |
| `customer_segment` | String | 고객 세그먼트 | Y | "Enterprise" |
| `promo_applied` | Boolean/String | 프로모션 적용 여부 | Y | True / False |
| `weekday` | String | 요일 | Y | "Mon", "Tue", ... |

---

### 4.2 계산 필드

| 필드명 | 계산 공식 | 설명 |
| --- | --- | --- |
| `overage_ratio` | `overage_cost_krw / monthly_cost_krw` | 월 과금 대비 오버리지 비중 |

---

## 5. 인터페이스 요구사항

### 5.1 입력 인터페이스

| 컴포넌트 | 유형 | ID | 기본값 |
| --- | --- | --- | --- |
| 월 과금 범위 | Range Slider | `monthly_cost` | 데이터 전체 범위 (min~max) |
| 트래픽 구간 | Checkbox Group | `traffic_window` | ["BUSINESS", "PEAK"] 모두 선택 |
| 필터 초기화 | Action Button | `reset` | - |
| 산점도 색상 기준 | Radio Buttons | `scatter_color` | "none" |
| 분포 그룹 기준 | Radio Buttons | `ratio_split_by` | "weekday" |

---

### 5.2 출력 인터페이스

| 컴포넌트 | 유형 | 위치 |
| --- | --- | --- |
| 조회 대상 건수 | Value Box | 상단 좌측 |
| 평균 오버리지 비중 | Value Box | 상단 중앙 |
| 평균 월 과금 | Value Box | 상단 우측 |
| 데이터 테이블 | DataGrid | 중단 좌측 (col-6) |
| 산점도 차트 | Scatter Plot | 중단 우측 (col-6) |
| 바이올린 플롯 | Violin Plot | 하단 전체 (col-12) |

---

## 6. 제약사항 및 가정

### 6.1 제약사항

| ID | 구분 | 내용 |
| --- | --- | --- |
| CON-001 | 데이터 | tips 데이터셋은 사전에 `shared.py`에서 로드되어 있어야 함 |
| CON-002 | 데이터 | 데이터 테이블은 최대 200행까지만 미리보기 제공 |
| CON-003 | 환경 | Python Shiny Express 모드로 실행 |
| CON-004 | 스타일 | `styles.css` 파일이 `app_dir` 경로에 존재해야 함 |

---

### 6.2 가정사항

| ID | 내용 |
| --- | --- |
| ASM-001 | 모든 데이터는 정제된 상태로 제공된다고 가정 |
| ASM-002 | monthly_cost_krw는 대부분 양수 값을 가진다고 가정 |
| ASM-003 | 사용자는 데스크톱 환경에서 주로 사용한다고 가정 |
| ASM-004 | 동시 접속 사용자 수는 제한적이라고 가정 (샘플 대시보드) |

---

## 7. 요구사항 추적 매트릭스 (RTM)

| 요구사항 ID | 구현 함수/컴포넌트 | 코드 라인 | 검증 방법 |
| --- | --- | --- | --- |
| FR-001 | `ui.input_slider("monthly_cost", ...)` | Line 18-24 | 슬라이더 조작 후 데이터 변경 확인 |
| FR-002 | `ui.input_checkbox_group("traffic_window", ...)` | Line 26-31 | 체크박스 토글 후 데이터 변경 확인 |
| FR-003 | `@reactive.event(input.reset)` | Line 149-152 | 버튼 클릭 후 필터 초기화 확인 |
| FR-004 | `def total_rows()` | Line 56-58 | 건수 표시 정확성 확인 |
| FR-005 | `def avg_overage_ratio()` | Line 62-67 | 비중 계산 정확성 확인 |
| FR-006 | `def avg_monthly_cost()` | Line 71-76 | 금액 계산 정확성 확인 |
| FR-007 | `def table()` | Line 84-85 | 테이블 렌더링 확인 |
| FR-008 | `def scatterplot()` | Line 97-122 | 산점도 렌더링 확인 |
| FR-010 | `def overage_ratio_dist()` | Line 136-147 | 바이올린 플롯 렌더링 확인 |
| FR-012 | `@reactive.calc def tips_data()` | Line 43-50 | 필터 변경 시 반응 확인 |

---

## 8. 용어 정의

| 용어 | 정의 |
| --- | --- |
| **월 과금 (monthly_cost_krw)** | 고객이 한 달간 사용한 클라우드 서비스의 총 청구 금액 (원) |
| **오버리지 (overage_cost_krw)** | 기본 요금제 초과 사용에 따른 추가 과금 금액 (원) |
| **오버리지 비중 (overage_ratio)** | 월 과금 대비 오버리지 비용의 비율 |
| **트래픽 구간** | 서비스 사용 시간대 구분 (BUSINESS: 업무시간, PEAK: 야간/피크) |
| **고객 세그먼트** | 고객 유형 분류 (예: Enterprise, SMB 등) |
| **Value Box** | 핵심 KPI를 시각적으로 강조하여 표시하는 UI 컴포넌트 |

---

## 9. 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
| --- | --- | --- | --- |
| v1.0 | 2026-01-14 | Ted(신태선) | 최초 작성 |

---